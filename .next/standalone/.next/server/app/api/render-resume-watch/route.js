"use strict";(()=>{var e={};e.id=116,e.ids=[116],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2081:e=>{e.exports=require("child_process")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},3837:e=>{e.exports=require("util")},3936:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>y,patchFetch:()=>f,requestAsyncStorage:()=>w,routeModule:()=>m,serverHooks:()=>D,staticGenerationAsyncStorage:()=>x});var o={};t.r(o),t.d(o,{GET:()=>h,POST:()=>g});var s=t(7092),n=t(5932),a=t(4147),i=t(7856),c=t(7147),l=t(1017),d=t(2081);let u=(0,t(3837).promisify)(d.exec),p=new Map;async function g(e){try{let{yamlContent:r,action:t}=await e.json();console.log("Watch API called with action:",t),console.log("YAML content length:",r?.length||0);let o=(0,l.join)(process.cwd(),"temp"),s=(0,l.join)(o,"resume.yaml");(0,c.existsSync)(o)||await u(`mkdir -p ${o}`);let n="/Users/arreyanhamid/Developer/ai-resume/designs",a=(0,l.join)(o,"designs");console.log("ATTEMPTING TO COPY DESIGNS FOLDER"),console.log("Source:",n),console.log("Target directory:",o),console.log("Expected target:",a);try{let e=await u(`ls -la "${n}"`);console.log("Source designs folder exists:",e.stdout),await u(`cp -r "${n}" "${o}/"`),console.log("✅ Entire designs folder copied to watch directory:",a);let r=await u(`ls -la "${a}"`);console.log("✅ Watch designs folder contents:",r.stdout)}catch(e){console.error("❌ Error copying designs folder for watch:",e),console.error("Copy error details:",e)}if("start"===t){let e=p.get(o);e&&(e.kill(),p.delete(o)),(0,c.writeFileSync)(s,r);try{console.log("\uD83D\uDE80 Starting rendercv watch process...");let e="designs/engineeringClassic.yaml";console.log("\uD83D\uDCC1 Working directory:",o),console.log("\uD83C\uDFA8 Design file:",e),console.log("\uD83D\uDCCB Full command: rendercv render resume.yaml --design",e,"--watch");let r=(0,d.spawn)("rendercv",["render","resume.yaml","--design",e,"--watch"],{cwd:o,detached:!1,stdio:["pipe","pipe","pipe"]});return p.set(o,r),r.stdout?.on("data",e=>{console.log("\uD83D\uDCC4 RenderCV stdout:",e.toString())}),r.stderr?.on("data",e=>{console.log("⚠️ RenderCV stderr:",e.toString())}),r.on("error",e=>{console.error("❌ RenderCV process error:",e)}),r.on("close",e=>{console.log("\uD83D\uDD1A RenderCV process closed with code:",e)}),r.on("exit",e=>{console.log(`Watch process exited with code: ${e}`),p.delete(o)}),await new Promise(e=>setTimeout(e,1e3)),i.NextResponse.json({status:"Watch started",processId:r.pid,outputDir:(0,l.join)(o,"rendercv_output")})}catch(e){return console.error("Failed to start watch process:",e),i.NextResponse.json({error:"Failed to start watch process"},{status:500})}}else if("stop"===t){let e=p.get(o);if(e)return e.kill(),p.delete(o),i.NextResponse.json({status:"Watch stopped"});return i.NextResponse.json({status:"No active watch process found"})}else if("update"===t)return(0,c.writeFileSync)(s,r),i.NextResponse.json({status:"YAML updated"});else return i.NextResponse.json({error:'Invalid action. Use "start", "stop", or "update"'},{status:400})}catch(e){return console.error("API Error:",e),i.NextResponse.json({error:"Internal server error"},{status:500})}}async function h(){let e=(0,l.join)(process.cwd(),"temp"),r=p.get(e);return i.NextResponse.json({active:!!r,processId:r?.pid||null,outputDir:(0,l.join)(e,"rendercv_output")})}let m=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/render-resume-watch/route",pathname:"/api/render-resume-watch",filename:"route",bundlePath:"app/api/render-resume-watch/route"},resolvedPagePath:"/Volumes/Crucible/resume-frontend-copy/resume-frontend/src/app/api/render-resume-watch/route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:w,staticGenerationAsyncStorage:x,serverHooks:D}=m,y="/api/render-resume-watch/route";function f(){return(0,a.patchFetch)({serverHooks:D,staticGenerationAsyncStorage:x})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[111,965],()=>t(3936));module.exports=o})();