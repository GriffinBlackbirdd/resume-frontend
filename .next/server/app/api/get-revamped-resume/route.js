"use strict";(()=>{var e={};e.id=831,e.ids=[831],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},6886:(e,r,t)=>{let o;t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>g,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>c});var s={};t.r(s),t.d(s,{GET:()=>d});var n=t(7092),a=t(5932),i=t(4147),u=t(7856),p=t(153);async function d(e){if(!o)return u.NextResponse.json({error:"Service temporarily unavailable"},{status:503});try{let{searchParams:r}=new URL(e.url),t=r.get("userId");if(!t)return u.NextResponse.json({error:"User ID is required"},{status:400});let{data:s,error:n}=await o.storage.from("generated-content").list(`${t}/`,{sortBy:{column:"created_at",order:"desc"}});if(n)return console.error("Error listing files:",n),u.NextResponse.json({error:"Failed to fetch revamped resumes"},{status:500});let a=s?.filter(e=>(e.name.includes("revamped")||e.name.includes("optimized"))&&e.name.endsWith(".pdf"))||[];if(0===a.length){let e=s?.filter(e=>e.name.endsWith(".pdf"))||[];if(e.length>0){let r=e[0],s=`${t}/${r.name}`,{data:n,error:a}=await o.storage.from("generated-content").download(s);if(a)return console.error("Error downloading file:",a),u.NextResponse.json({error:"Failed to download revamped resume"},{status:500});return new u.NextResponse(n,{status:200,headers:{"Content-Type":"application/pdf","Cache-Control":"no-cache, no-store, must-revalidate"}})}return u.NextResponse.json({error:"No revamped resume found"},{status:404})}let i=a[0],p=`${t}/${i.name}`,{data:d,error:l}=await o.storage.from("generated-content").download(p);if(l)return console.error("Error downloading file:",l),u.NextResponse.json({error:"Failed to download revamped resume"},{status:500});return new u.NextResponse(d,{status:200,headers:{"Content-Type":"application/pdf","Cache-Control":"no-cache, no-store, must-revalidate"}})}catch(e){return console.error("API Error:",e),u.NextResponse.json({error:"Internal server error"},{status:500})}}process.env.NEXT_PUBLIC_SUPABASE_URL&&process.env.SUPABASE_SERVICE_ROLE_KEY&&(o=(0,p.eI)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY));let l=new n.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/get-revamped-resume/route",pathname:"/api/get-revamped-resume",filename:"route",bundlePath:"app/api/get-revamped-resume/route"},resolvedPagePath:"/Volumes/Crucible/resume-frontend-copy/resume-frontend/src/app/api/get-revamped-resume/route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:c,serverHooks:f}=l,v="/api/get-revamped-resume/route";function g(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:c})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[111,965,153],()=>t(6886));module.exports=o})();